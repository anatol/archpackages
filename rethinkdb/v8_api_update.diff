diff --git a/src/extproc/js_job.cc b/src/extproc/js_job.cc
index 984aea0..3ee0533 100644
--- a/src/extproc/js_job.cc
+++ b/src/extproc/js_job.cc
@@ -66,6 +66,7 @@ public:
     v8::Persistent<v8::Context> context;
 #else
     js_context_t() :
+        local_scope(v8::Isolate::GetCurrent()),
         context(v8::Context::New(v8::Isolate::GetCurrent())),
         scope(context) { }
 
@@ -219,7 +220,7 @@ js_result_t js_env_t::eval(const std::string &source) {
     js_result_t result("");
     std::string *errmsg = boost::get<std::string>(&result);
 
-    v8::HandleScope handle_scope;
+    v8::HandleScope handle_scope(v8::Isolate::GetCurrent());
 
     // TODO: use an "external resource" to avoid copy?
     v8::Handle<v8::String> src = v8::String::New(source.data(), source.size());
@@ -290,7 +291,7 @@ v8::Handle<v8::Value> run_js_func(v8::Handle<v8::Function> fn,
                                   const std::vector<counted_t<const ql::datum_t> > &args,
                                   std::string *errmsg) {
     v8::TryCatch try_catch;
-    v8::HandleScope scope;
+    v8::HandleScope scope(v8::Isolate::GetCurrent());
 
     // Construct receiver object.
     v8::Handle<v8::Object> obj = v8::Object::New();
@@ -320,7 +321,7 @@ js_result_t js_env_t::call(js_id_t id,
     const boost::shared_ptr<v8::Persistent<v8::Value> > found_value = find_value(id);
     guarantee(!found_value->IsEmpty());
 
-    v8::HandleScope handle_scope;
+    v8::HandleScope handle_scope(v8::Isolate::GetCurrent());
 
     // Construct local handle from persistent handle
 
@@ -367,7 +368,7 @@ counted_t<const ql::datum_t> js_make_datum(const v8::Handle<v8::Value> &value,
     --recursion_limit;
 
     // TODO: should we handle BooleanObject, NumberObject, StringObject?
-    v8::HandleScope handle_scope;
+    v8::HandleScope handle_scope(v8::Isolate::GetCurrent());
 
     if (value->IsString()) {
         v8::Handle<v8::String> string = value->ToString();
@@ -471,7 +472,7 @@ counted_t<const ql::datum_t> js_to_datum(const v8::Handle<v8::Value> &value, std
     guarantee(!value.IsEmpty());
     guarantee(errmsg != NULL);
 
-    v8::HandleScope handle_scope;
+    v8::HandleScope handle_scope(v8::Isolate::GetCurrent());
     errmsg->assign("Unknown error when converting to ql::datum_t.");
 
     return js_make_datum(value, TO_JSON_RECURSION_LIMIT, errmsg);
@@ -497,7 +498,7 @@ v8::Handle<v8::Value> js_from_datum(const counted_t<const ql::datum_t> &datum) {
         const std::vector<counted_t<const ql::datum_t> > &source_array = datum->as_array();
 
         for (size_t i = 0; i < source_array.size(); ++i) {
-            v8::HandleScope scope;
+            v8::HandleScope scope(v8::Isolate::GetCurrent());
             v8::Handle<v8::Value> val = js_from_datum(source_array[i]);
             guarantee(!val.IsEmpty());
             array->Set(i, val);
@@ -515,7 +516,7 @@ v8::Handle<v8::Value> js_from_datum(const counted_t<const ql::datum_t> &datum) {
             const std::map<std::string, counted_t<const ql::datum_t> > &source_map = datum->as_object();
 
             for (auto it = source_map.begin(); it != source_map.end(); ++it) {
-                v8::HandleScope scope;
+                v8::HandleScope scope(v8::Isolate::GetCurrent());
                 v8::Handle<v8::Value> key = v8::String::New(it->first.c_str());
                 v8::Handle<v8::Value> val = js_from_datum(it->second);
                 guarantee(!key.IsEmpty() && !val.IsEmpty());
