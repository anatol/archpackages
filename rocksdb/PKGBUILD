# Maintainer: Anatol Pomozov <anatol.pomozov@gmail.com>

pkgname=rocksdb
pkgver=2.7
pkgrel=1
pkgdesc='Embedded key-value store for fast storage'
arch=(i686 x86_64)
url='http://rocksdb.org'
license=(BSD)
depends=(gflags)
checkdepends=(python2)
backup=()
source=(
  https://github.com/facebook/rocksdb/archive/$pkgver.fb.zip
)
sha256sums=('a0e5553549c169cbdb3c53e82e3f5422821e604ac5671836d8e3f00c5bc327d1')

prepare() {
  cd $pkgname-$pkgver.fb
  sed -e 's/\bpython\b/python2/' -i Makefile
}

build() {
  cd $pkgname-$pkgver.fb
  make all librocksdb.so
}

# The are some tests are broken in 2.6 release
#check() {
#  cd $pkgname-$pkgver.fb
#  make check
#}

package() {
  cd $pkgname-$pkgver.fb
  make DESTDIR="$pkgdir" install
}
